const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./ParticlesComponent-ChxHmwc4.js","./react-vendors-EQJ1DewU.js","./vendor-DmCBWs0o.js","./react-vendors-DIKJ0DAD.css"])))=>i.map(i=>d[i]);
import{_ as v,A as I}from"./index-BwovoiXw.js";import{R as N,r as a,Q as L,j as e,k as A,T as x,U as l,V as U,W as _,X as R,Y as E,Z as P,_ as B,$ as h,a0 as m,p as g,a1 as j,w as i,C as M}from"./react-vendors-EQJ1DewU.js";import{k as t,D as z,E as D}from"./vendor-DmCBWs0o.js";import{e as F}from"./icons8-error-EK1qFjAG.js";const O=N.lazy(()=>v(()=>import("./ParticlesComponent-ChxHmwc4.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)),V=()=>{const[p,C]=a.useState(""),[d,y]=a.useState(""),u=t.get("responseMessage"),[b,n]=a.useState(!1),f=L(),{setRole:k,setUsername:T,setAuthToken:w}=a.useContext(I),S=async r=>{r.preventDefault(),n(!0);try{const o="https://wazimobile-sms-backend.onrender.com/";console.log("Base URL:",o);const c=await fetch(`${o}auth/authenticate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:p,password:d})});if(!c.ok)throw new Error(`HTTP error! status: ${c.status}`);const s=await c.json();console.log(s),n(!1),k(s.role),T(s.user),w({accessToken:s.accessToken,refreshToken:s.refreshToken}),t.set("username",s.user,{expires:7,secure:!0,sameSite:"Strict",path:"/"}),t.set("role",s.role,{expires:7,secure:!0,sameSite:"Strict",path:"/"}),t.set("refreshToken",s.accessToken,{expires:7,secure:!0,sameSite:"Strict",path:"/"}),t.set("responseMessage",s.responseMessage,{expires:7,secure:!0,sameSite:"Strict",path:"/"})}catch(o){console.error("There was a problem with the fetch operation:",o),n(!1)}f("/dashboard")};return e.jsx(O,{children:e.jsx("div",{style:{backgroundImage:"url('src/assets/images/login-bg.jpg')",backgroundRepeat:"no-repeat",backgroundColor:"rgba(0,0,0,0.5)",backgroundSize:"cover",backgroundBlendMode:"multiply",overflow:"hidden"},children:e.jsx(A,{children:e.jsx(x,{className:"justify-content-center",children:e.jsxs(l,{md:4,children:[e.jsx("h3",{style:{textAlign:"center",color:"#fff",padding:"20px"},children:"WAZI MOBILE"}),e.jsx(U,{children:e.jsx(_,{className:"p-4",style:{boxShadow:"0px 15px 34px 0px rgba(0,0,0,0.2)"},children:e.jsxs(R,{children:[u=="Login Failed"?e.jsxs(E,{color:"danger",style:{textAlign:"center"},children:[e.jsx(P,{src:F,height:50}),e.jsx("h5",{style:{margin:"4px 0px"},children:u}),e.jsx("p",{style:{margin:"0"},children:"Wrong username or password. Try again"})]}):null,e.jsxs(B,{onSubmit:S,style:{textAlign:"center"},children:[e.jsx("h1",{style:{marginTop:"10px"},children:"Login"}),e.jsx("p",{className:"text-body-secondary",style:{marginTop:"10px"},children:"Sign In to your account"}),e.jsxs(h,{className:"mb-3",style:{marginTop:"20px"},children:[e.jsx(m,{style:{borderColor:"rgb(71, 71, 212)",backgroundColor:"rgb(71, 71, 212)",color:"#fff"},children:e.jsx(g,{icon:z})}),e.jsx(j,{placeholder:"Username",autoComplete:"username",value:p,onChange:r=>C(r.target.value),style:{borderColor:"rgb(71, 71, 212)"},required:!0})]}),e.jsxs(h,{className:"mb-4",children:[e.jsx(m,{style:{borderColor:"rgb(71, 71, 212)",backgroundColor:"rgb(71, 71, 212)",color:"#fff"},children:e.jsx(g,{icon:D})}),e.jsx(j,{type:"password",placeholder:"Password",autoComplete:"current-password",value:d,onChange:r=>y(r.target.value),required:!0,style:{borderColor:"rgb(71, 71, 212)"}})]}),e.jsxs(x,{children:[e.jsx(l,{xs:12,style:{marginTop:"15px"},children:b?e.jsxs(i,{color:"success",type:"submit",className:"px-4",disabled:!0,style:{width:"100%"},children:[e.jsx(M,{as:"span",size:"sm"})," authenticating ..."]}):e.jsx(i,{color:"primary",className:"px-4",type:"submit",style:{width:"100%"},children:"Login"})}),e.jsx(l,{xs:12,className:"text-right",style:{marginTop:"15px"},children:e.jsx(i,{color:"link",className:"px-0",children:"Forgot password?"})})]})]})]})})})]})})})})})};export{V as default};

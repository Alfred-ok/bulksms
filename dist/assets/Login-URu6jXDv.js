const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./ParticlesComponent-Boa5Du6E.js","./react-vendors-zvsUqyxL.js","./vendor-BDCZ_RMd.js","./react-vendors-DIKJ0DAD.css"])))=>i.map(i=>d[i]);
import{_ as v,A as L}from"./index-K0m3Hw1Q.js";import{R as N,r as n,L as A,j as e,k as U,M as x,Q as l,T as h,U as _,V as E,W as P,X as R,Y as m,Z as g,p as j,_ as y,w as i,C as M}from"./react-vendors-zvsUqyxL.js";import{k as r,D as B,E as D}from"./vendor-BDCZ_RMd.js";import{e as F}from"./icons8-error-EK1qFjAG.js";const O=N.lazy(()=>v(()=>import("./ParticlesComponent-Boa5Du6E.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)),V=()=>{const[p,C]=n.useState(""),[d,b]=n.useState(""),u=r.get("responseMessage"),[f,c]=n.useState(!1),S=A(),{setRole:T,setUsername:w,setAuthToken:k}=n.useContext(L),I=async t=>{t.preventDefault(),c(!0);try{const o="https://wazimobile-sms-backend.onrender.com/";console.log("Base URL:",o);const a=await fetch(`${o}auth/authenticate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:p,password:d})});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);console.log(a);const s=await a.json();console.log(s),c(!1),T(s.role),w(s.user),k({accessToken:s.accessToken,refreshToken:s.refreshToken}),r.set("username",s.user,{expires:7,secure:!0,sameSite:"Strict",path:"/"}),r.set("role",s.role,{expires:7,secure:!0,sameSite:"Strict",path:"/"}),r.set("refreshToken",s.accessToken,{expires:7,secure:!0,sameSite:"Strict",path:"/"}),r.set("responseMessage",s.responseMessage,{expires:7,secure:!0,sameSite:"Strict",path:"/"}),r.set("groupId",s.groupId,{expires:7,secure:!0,sameSite:"Strict",path:"/"})}catch(o){console.error("There was a problem with the fetch operation:",o),c(!1)}S("/dashboard")};return e.jsx(O,{children:e.jsx("div",{children:e.jsx(U,{children:e.jsx(x,{className:"justify-content-center",children:e.jsxs(l,{md:4,children:[e.jsx(h,{variant:"solid",style:{backgroundColor:"transparent",border:"none"},children:e.jsx("h3",{style:{textAlign:"center",color:"#fff",padding:"20px"},children:"WAZI MOBILE"})}),e.jsx(h,{className:"p-4",style:{boxShadow:"0px 15px 34px 0px rgba(0,0,0,0.2)"},children:e.jsxs(_,{children:[u=="Login Failed"?e.jsxs(E,{color:"danger",style:{textAlign:"center"},children:[e.jsx(P,{src:F,height:50}),e.jsx("h5",{style:{margin:"4px 0px"},children:u}),e.jsx("p",{style:{margin:"0"},children:"Wrong username or password. Try again"})]}):null,e.jsxs(R,{onSubmit:I,style:{textAlign:"center"},children:[e.jsx("h1",{style:{marginTop:"10px"},children:"Login"}),e.jsx("p",{className:"text-body-secondary",style:{marginTop:"10px"},children:"Sign In to your account"}),e.jsxs(m,{className:"mb-3",style:{marginTop:"20px"},children:[e.jsx(g,{style:{borderColor:"rgb(71, 71, 212)",backgroundColor:"rgb(71, 71, 212)",color:"#fff"},children:e.jsx(j,{icon:B})}),e.jsx(y,{placeholder:"Username",autoComplete:"username",value:p,onChange:t=>C(t.target.value),style:{borderColor:"rgb(71, 71, 212)"},required:!0})]}),e.jsxs(m,{className:"mb-4",children:[e.jsx(g,{style:{borderColor:"rgb(71, 71, 212)",backgroundColor:"rgb(71, 71, 212)",color:"#fff"},children:e.jsx(j,{icon:D})}),e.jsx(y,{type:"password",placeholder:"Password",autoComplete:"current-password",value:d,onChange:t=>b(t.target.value),required:!0,style:{borderColor:"rgb(71, 71, 212)"}})]}),e.jsxs(x,{children:[e.jsx(l,{xs:12,style:{marginTop:"15px"},children:f?e.jsxs(i,{color:"success",type:"submit",className:"px-4",disabled:!0,style:{width:"100%"},children:[e.jsx(M,{as:"span",size:"sm"})," authenticating ..."]}):e.jsx(i,{color:"primary",className:"px-4",type:"submit",style:{width:"100%"},children:"Login"})}),e.jsx(l,{xs:12,className:"text-right",style:{marginTop:"15px"},children:e.jsx(i,{color:"link",className:"px-0",children:"Forgot password?"})})]})]})]})})]})})})})})};export{V as default};
